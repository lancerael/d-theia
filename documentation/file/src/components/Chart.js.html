<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <base data-ice="baseUrl" href="../../../" />
    <title data-ice="title">src/components/Chart.js | d-theia</title>
    <link type="text/css" rel="stylesheet" href="css/style.css" />
    <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css" />
    <script src="script/prettify/prettify.js"></script>
    <script src="script/manual.js"></script>
  </head>
  <body class="layout-container" data-ice="rootContainer">
    <header>
      <a href="./"><img src="./image/dt-logo.png" title="dTheia" /></a>

      <a href="identifiers.html">Reference</a>
      <a href="source.html">Source</a>

      <div class="search-box">
        <span>
          <img src="./image/search.png" />
          <span class="search-input-edge"></span
          ><input class="search-input" /><span class="search-input-edge"></span>
        </span>
        <ul class="search-result"></ul>
      </div>
    </header>

    <nav class="navigation" data-ice="nav">
      <div>
        <ul>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/Theia.js~Theia.html">Theia</a></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <a
              data-ice="dirPath"
              class="nav-dir-path"
              href="identifiers.html#components"
              >components</a
            ><span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/Axis.js~Axis.html">Axis</a></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/AxisChart.js~AxisChart.html"
                  >AxisChart</a
                ></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/BarChart.js~BarChart.html"
                  >BarChart</a
                ></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/BubbleChart.js~BubbleChart.html"
                  >BubbleChart</a
                ></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/Chart.js~Chart.html"
                  >Chart</a
                ></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/Colors.js~Colors.html"
                  >Colors</a
                ></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/DataOps.js~DataOps.html"
                  >DataOps</a
                ></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/Key.js~Key.html">Key</a></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/LineChart.js~LineChart.html"
                  >LineChart</a
                ></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/Tooltip.js~Tooltip.html"
                  >Tooltip</a
                ></span
              ></span
            >
          </li>
          <li data-ice="doc">
            <span data-ice="kind" class="kind-class">C</span
            ><span data-ice="name"
              ><span
                ><a href="class/src/components/Utilities.js~Utilities.html"
                  >Utilities</a
                ></span
              ></span
            >
          </li>
        </ul>
      </div>
    </nav>

    <div class="content" data-ice="content">
      <h1 data-ice="title">src/components/Chart.js</h1>
      <pre
        class="source-code line-number raw-source-code"
      ><code class="prettyprint linenums" data-ice="content">import { select } from &apos;d3-selection&apos;;
import Tooltip from &apos;./Tooltip&apos;;
import DataOps from &apos;./DataOps&apos;;

/**
* The Chart object is the parent class for all types of Chart.
* It is used to initialise all of the base settings universal to all charts.
*
* @class Chart
* @constructor
*/
export default class Chart {

  /**
  * SVG DOM object for displaying the chart
  *
  * @property svg
  * @type {Object}
  */
  svg;

  /**
  * SVG d3 object for d3 operations on the chart
  *
  * @property d3Svg
  * @type {Object}
  */
  d3Svg;

  /**
  * Default time for d3 transitions on the chart
  *
  * @property transitionTime
  * @type {Number}
  */
  transitionTime;

  /**
  * DOM reference to container element that wraps SVG
  *
  * @property container
  * @type {Object}
  */
  container;

  /**
  * DOM reference to loader display element
  *
  * @property loader
  * @type {Object}
  */
  loader;

  /**
  * Chart&apos;s tooltip object
  *
  * @property tooltip
  * @type {Object}
  */
  tooltip;

  /**
  * The current calculated width of the chart
  *
  * @property width
  * @type {Number}
  */
  width;

  /**
  * The current calculated height of the chart
  *
  * @property height
  * @type {Number}
  */
  height;

  /**
  * The current calculated inner width of the chart
  *
  * @property innerWidth
  * @type {Number}
  */
  innerWidth;

  /**
  * The current calculated inner height of the chart
  *
  * @property innerHeight
  * @type {Number}
  */
  innerHeight;

  /**
  * The width before any browser resize
  *
  * @property initialWidth
  * @type {Number}
  */
  initialWidth;

  /**
  * The padding for the chart within the container
  *
  * @property padding
  * @type {Object}
  */
  padding;

  /**
  * The chart&apos;s config object
  *
  * @property chartConfig
  * @type {Object}
  */
  chartConfig;

  /**
  * The chart&apos;s data
  *
  * @property chartData
  * @type {Array}
  */
  chartData;

  /**
  * Constructor function that sets up the local object.
  *
  * @method constructor
  * @param {Object} chartConfig JSON configuration object
  * @param {Array} chartData the data to be displayed
  * @param {String} containerId Optional ID to select DOM object
  * @param {Object} container Optional DOM object in place of ID
  */
  constructor(chartParams = {}) {
    const { chartConfig, chartData, containerId } = chartParams;
    let { container } = chartParams;
    this.svg = document.createElementNS(&apos;http://www.w3.org/2000/svg&apos;, &apos;svg&apos;);
    this.d3Svg = select(this.svg);
    this.transitionTime = 500;
    this.padding = { l: 5, r: 5, t: 5, b: 5 };
    this.loader = document.createElement(&apos;div&apos;);
    this.loader.className = &apos;dt-loader&apos;;
    if (!container &amp;&amp; containerId) {
      container = document.getElementById(containerId);
    }
    if (container) {
      this.setContainer(container);
    }
    if (chartConfig) {
      this.setConfig(chartConfig);
    }
    if (chartData) {
      this.setData(chartData);
    }
  }

  /**
  * Sets the local container object.
  *
  * @method setContainer
  * @param {Object} container Required DOM element
  * @throws {Error} invalid DOM element
  */
  setContainer(container) {
    if (container.nodeName) {
      container.appendChild(this.loader);
      this.container = container;
    } else {
      throw new Error(&apos;No valid DOM element or ID provided for chart.&apos;);
    }
  }

  /**
  * Sets the local config options for the chart.
  *
  * @method setConfig
  * @param {Object} chartConfig JSON configuration object
  * @throws {Error} missing configuration
  */
  setConfig(chartConfig) {
    if (chartConfig &amp;&amp; chartConfig.toString() === &apos;[object Object]&apos;) {
      if (chartConfig.itemValues) {
        chartConfig.itemValues = DataOps.addColoursToConfig(chartConfig.itemValues);
      }
      this.chartConfig = chartConfig;
    } else {
      throw new Error(&apos;No valid configuration provided for chart.&apos;);
    }
  }

  /**
  * Sets the local data for the chart.
  *
  * @method setData
  * @param {Array} chartData array of JSON objects
  * @param {Boolean} doTransform transform mapped data
  * @throws {Error} missing data
  */
  setData(chartData, doTransform = true) {
    if (chartData &amp;&amp; Array.isArray(chartData) === true) {
      if (this.chartConfig &amp;&amp; doTransform) {
        chartData = DataOps.transformDataKeys(this.chartConfig, chartData);
      }
      this.chartData = chartData;
    } else {
      throw new Error(&apos;No valid data provided for chart.&apos;);
    }
  }

  /**
  * Updates the local data for the chart.
  *
  * @method updateData
  * @param {Array} chartData array of JSON objects
  * @param {Boolean} doTransform transform mapped data
  */
  updateData(chartData, doTransform = true) {
    this.setData(chartData, doTransform);
    this.setDimensions();
    if (this.axis) {
      this.axis.render();
    }
    if (this.renderChart) {
      this.renderChart();
    }
  }

  /**
  * Updates the local config for the chart.
  *
  * @method updateConfig
  * @param {JSON} chartConfig config JSON style object
  */
  updateConfig(chartConfig) {
    this.setConfig(chartConfig);
    if (this.renderChart) {
      this.renderChart(true, false);
    }
  }

  /**
  * Sets the local chart dimensions based on the size of the container.
  *
  * @method setDimensions
  * @throws {Error} missing DOM element
  */
  setDimensions() {
    if (this.container &amp;&amp; this.container.nodeName) {
      this.width = this.container.clientWidth;
      this.height = this.container.clientHeight;
      this.innerWidth = this.width - this.padding.l - this.padding.r;
      this.innerHeight = this.height - this.padding.t - this.padding.b;
    } else {
      throw new Error(&apos;Cannot set dimensions of chart without container element.&apos;);
    }
  }

  /**
  * Check chart is ready and render.
  *
  * @method init
  * @throws {Error} chart not ready for initialisation
  * @chainable
  */
  init() {
    this.setDimensions();
    if (this.chartData &amp;&amp; this.chartConfig &amp;&amp; !isNaN(this.width) &amp;&amp; !isNaN(this.height)) {
      this.initialWidth = this.width;
      this.tooltip = new Tooltip(this.container).create();
      select(this.container).append(&apos;div&apos;).attr(&apos;class&apos;, &apos;title&apos;).text(this.chartConfig.title);
      this.svg.setAttribute(&apos;class&apos;, &apos;chart&apos;);
      this.container.appendChild(this.svg);
      this.resizeWatcher = this.resizeWatcher || window.addEventListener(&apos;resize&apos;, () =&gt; {
        this.setDimensions();
        this.resizeOffset = this.width - this.initialWidth;
        if (this.renderChart) {
          this.renderChart();
        }
        this.tooltip.hide();
      });
      this.chartOutWatcher = this.chartOutWatcher || this.svg.addEventListener(&apos;mouseout&apos;, () =&gt; {
        this.tooltip.hide();
      });
      if (this.renderChart) {
        this.renderChart();
      }
      this.container.removeChild(this.loader);
      return this;
    }
    throw new Error(&apos;The chart is not ready for initialisation.&apos;);
  }

}

module.exports = Chart;
</code></pre>
    </div>

    <footer class="footer">
      Generated by
      <a href="https://esdoc.org"
        >ESDoc<span data-ice="esdocVersion">(1.1.0)</span
        ><img src="./image/esdoc-logo-mini-black.png"
      /></a>
    </footer>

    <script src="script/search_index.js"></script>
    <script src="script/search.js"></script>
    <script src="script/pretty-print.js"></script>
    <script src="script/inherited-summary.js"></script>
    <script src="script/test-summary.js"></script>
    <script src="script/inner-link.js"></script>
    <script src="script/patch-for-local.js"></script>
  </body>
</html>
